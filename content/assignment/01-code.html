---
title: "Práctica 1. Procesamiento de datos en R"
subtitle: "Estadistica Multivariada - Sociología FACSO Universidad de Chile"
linktitle: "Práctica 1"
date: "2020-01-10"
class_date: "2020-04-03"
citeproc: false
bibliography: ../../static/bib/references.bib
csl: ../../static/bib/chicago-syllabus-no-bib.csl
output:
  blogdown::html_page:
    template: ../../pandoc/toc-title_html.template
    toc: true
    highlight: tango
    number_sections: FALSE
menu:
  class:
    parent: Practicas
    weight: 1
type: docs
weight: 1
editor_options:
  chunk_output_type: console
---

<!-- BLOGDOWN-HEAD -->
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>
<!-- /BLOGDOWN-HEAD -->

<h2>Índice</h2>
<div id="TOC">
<ul>
<li><a href="#presentación">Presentación</a><ul>
<li><a href="#objetivo-de-la-práctica">Objetivo de la práctica</a></li>
<li><a href="#antecedentes-de-los-datos-a-utilizar">Antecedentes de los datos a utilizar</a></li>
<li><a href="#tutorial-de-instalación-de-r">Tutorial de instalación de R</a></li>
</ul></li>
<li><a href="#preparacion-de-datos-con-elsoc-2016">Preparacion de datos con ELSOC 2016</a><ul>
<li><a href="#librerías">1. Librerías</a></li>
<li><a href="#cargar-base-de-datos">2. Cargar base de datos</a><ul>
<li><a href="#datos-perdidos">Datos perdidos</a></li>
</ul></li>
<li><a href="#recodificacion-variables-percepcion-de-meritocracia">Recodificacion Variables percepcion de meritocracia</a></li>
<li><a href="#recodificacion-variable-estatus-subjetivo">Recodificacion variable Estatus subjetivo</a></li>
<li><a href="#recodificacion-variables-estatus-objetivo">Recodificacion variables Estatus objetivo</a><ul>
<li><a href="#ingresos-del-hogar">Ingresos del hogar</a></li>
<li><a href="#educación">Educación</a></li>
</ul></li>
<li><a href="#variables-control">Variables control</a></li>
</ul></li>
<li><a href="#mantener-variables-relevantes">Mantener variables relevantes</a></li>
</ul>
</div>

<div id="presentación" class="section level1">
<h1>Presentación</h1>
<div id="objetivo-de-la-práctica" class="section level2">
<h2>Objetivo de la práctica</h2>
<p>El desarrollo de esta guía tiene por objetivo revisar algunos procedimientos básicos del procesamiento de datos con R, que son necesarios para luego poder aplicar los contenidos más específicos de este curso.</p>
<p>En este curso vamos a distinguir <strong>dos momentos</strong> del trabajo con datos: procesamiento y análisis.</p>
<ul>
<li><p><strong>Procesamiento</strong> corresponde a lo que se conoce generalmente como “limpieza”, es decir, realizar las modificaciones necesarias para poder efectuar los análisis. Estas modificaciones previas al análisis son necesarias ya que los datos originales con los que se va a trabajar en general no vienen perfectamente adaptados a los análisis que se quieren hacer. Por lo tanto, en cuanto a datos también hacemos la distinción entre datos originales y datos procesados.</p></li>
<li><p><strong>Análisis</strong>: se relaciona principalmente con análisis descriptivos asociados a las preguntas de investigación y también modelamiento de datos para contrastar hipótesis de investigación.</p></li>
</ul>
<p>Tanto el procesamiento como el análisis quedan registrados en un documento de código, en este caso de código R (por lo general, un archivo con extensión .R). El documento de código de procesamiento posee 5 partes, más una sección de identificación inicial:</p>
<ol start="0" style="list-style-type: decimal">
<li>Identificación y descripción general: Título, autor(es), fecha, información breve sobre el contenido del documento</li>
<li>Librerías principales (de R) a utilizar en el análisis</li>
<li>Carga de datos</li>
<li>Selección de variables a utilizar</li>
<li>Procesamiento de variables: en este punto, por cada variable</li>
</ol>
<ul>
<li>Descriptivo general</li>
<li>Recodificación de datos perdidos</li>
<li>Recodificación de valores (en caso de ser necesario)</li>
<li>Etiquetamiento /re-etiquetamiento (en caso de ser necesario)</li>
</ul>
<ol start="5" style="list-style-type: decimal">
<li>Generación de base de datos procesada para el análisis.</li>
</ol>
<p>Al final de esta práctica la idea es que cada un_ elabore y entienda su propio documento de procesamiento de datos.</p>
<p>En el ejemplo vamos a procesar variables de meritocracia y estatus (objetivo y subjetivo) utilizando los datos de ELSOC.</p>
</div>
<div id="antecedentes-de-los-datos-a-utilizar" class="section level2">
<h2>Antecedentes de los datos a utilizar</h2>
<p>El Estudio Longitudinal Social de Chile <a href="https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/0KIRBJ">(ELSOC)</a> es una encuesta desarrollada para analizar intertemporalmente la evolución del conflicto y cohesión en la sociedad chilena.</p>
<p>Uno de los módulos de <strong>ELSOC</strong> es “Desigualdad y Legitimidad”. Este módulo busca estudiar las percepciones y atribuciones asociadas a las desigualdades sociales. Se ve motivado por el interés de comprender cómo las personas perciben, legitiman y reproducen las diferencias de ingresos, estatus y poder presentes en el Chile contemporáneo.</p>
<p>El presente ejercicio tiene por objetivo el procesar los datos para obtener las variables relevante para el estudio de la <strong>Percepción de Meritocracia</strong>, entendida como el grado en que los individuos consideran que su sociedad cumple con los principios de una meritocracia, es decir, que funciona como un sistema que asigna recompensas en función del esfuerzo y las habilidades.</p>
</div>
<div id="tutorial-de-instalación-de-r" class="section level2">
<h2>Tutorial de instalación de R</h2>
<p>Para quienes no trabajan en R constantemente, va un primer tutorial abajo sobre instalación de R y RStudio, necesarios para poder desarrollar esta práctica:</p>
<div style="width: 100%; height: 600px; overflow: hidden;">
<video  style="width: 100%;" controls>
<source src="https://www.dropbox.com/s/q0jg4pv3ihtf2qd/tutorialR_editedjc.mp4?raw=1" type="video/mp4">
</video>
</div>
</div>
</div>
<div id="preparacion-de-datos-con-elsoc-2016" class="section level1">
<h1>Preparacion de datos con ELSOC 2016</h1>
<div id="librerías" class="section level2">
<h2>1. Librerías</h2>
<p>Las librerías que vamos a utilizar principalmente son dplyr (ajuste general de datos) y …
De todas maneras se recomienda realizar un comentario con el signo <strong>#</strong> luego de la librería a cargar para recordar su contenido.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(dplyr) <span class="co"># ajuste general de datos</span></a></code></pre></div>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>()) <span class="co"># borrar todos los objetos en el enviorment</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw">options</span>(<span class="dt">scipen=</span><span class="dv">999</span>) <span class="co">#sin notacion cientifica</span></a></code></pre></div>
</div>
<div id="cargar-base-de-datos" class="section level2">
<h2>2. Cargar base de datos</h2>
<p>Las bases de datos se pueden cargar de un archivo local o en línea. Para este caso utilizaremos un archivo en línea que viene en formato RData: <strong>ELSOC_W01_v3.10.RData</strong>.</p>
<p>La base se agrega como un objeto al espacio de trabajo con el nombre original “elsoc_2016”. Para facilitar los análisis se le cambia el nombre simplemente a elsoc con la segunda instrucción</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">load</span>(<span class="st">&quot;url(https://multivariada.netlify.com/assignment/data/original/ELSOC_W01_v3.10.RData&quot;</span>)<span class="er">)</span></a>
<a class="sourceLine" id="cb6-2" title="2">elsoc &lt;-<span class="st"> </span>elsoc_<span class="dv">2016</span>; <span class="kw">remove</span>(elsoc_<span class="dv">2016</span>)</a></code></pre></div>
<div id="datos-perdidos" class="section level3">
<h3>Datos perdidos</h3>
<ul>
<li>En ELSOC todos los valores -888 y -999 corresponden a valores para las categorias “No sabe” y “No responde”, respectivamente.</li>
<li>Decidimos dejarlas como valores perdidos (NA)</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(elsoc)) {</a>
<a class="sourceLine" id="cb7-2" title="2">  elsoc[,i][elsoc[,i] <span class="op">==</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">888</span>)]  &lt;-<span class="st"> </span><span class="ot">NA</span> <span class="co">#Missing</span></a>
<a class="sourceLine" id="cb7-3" title="3">  elsoc[,i][elsoc[,i] <span class="op">==</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">999</span>)]  &lt;-<span class="st"> </span><span class="ot">NA</span> <span class="co">#Missing</span></a>
<a class="sourceLine" id="cb7-4" title="4">  }</a></code></pre></div>
</div>
</div>
<div id="recodificacion-variables-percepcion-de-meritocracia" class="section level2">
<h2>Recodificacion Variables percepcion de meritocracia</h2>
<ul>
<li>[<code>c18_09</code>]: “Grado de acuerdo: Las personas son recompensadas por sus esfuerzos” (1 = Totalmente en desacuerdo; 5 = Totalmente de acuerdo)</li>
<li>[<code>c18_10</code>]: “Grado de acuerdo: Las personas son recompensada por su inteligencia” (1 = Totalmente en desacuerdo; 5 = Totalmente de acuerdo)</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">elsoc<span class="op">$</span>c18_<span class="dv">09</span> &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(elsoc<span class="op">$</span>c18_<span class="dv">09</span>)</a>
<a class="sourceLine" id="cb8-2" title="2">elsoc<span class="op">$</span>c18_<span class="dv">10</span> &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(elsoc<span class="op">$</span>c18_<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co"># Variables meritocracia promedio -----------------------------------------</span></a>
<a class="sourceLine" id="cb8-4" title="4">elsoc &lt;-<span class="st"> </span><span class="kw">rename</span>(elsoc,<span class="dt">meffort=</span>c18_<span class="dv">09</span>) <span class="co"># cambio de nombre de la variable c18_09 a uno mas sustantivo</span></a>
<a class="sourceLine" id="cb8-5" title="5">elsoc &lt;-<span class="st"> </span><span class="kw">rename</span>(elsoc,<span class="dt">mtalent=</span>c18_<span class="dv">10</span>) <span class="co"># cambio de nombre de la variable c18_10 a uno mas sustantivo</span></a>
<a class="sourceLine" id="cb8-6" title="6"></a>
<a class="sourceLine" id="cb8-7" title="7"><span class="co"># creamos un indice promedio de percepcion de meritocracia usando ambas preguntas</span></a>
<a class="sourceLine" id="cb8-8" title="8">elsoc<span class="op">$</span>merit &lt;-<span class="st"> </span>(elsoc<span class="op">$</span>meffort<span class="op">+</span>elsoc<span class="op">$</span>mtalent)<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb8-9" title="9"></a>
<a class="sourceLine" id="cb8-10" title="10"><span class="co"># re escalamos la variable de 1-5 a una de 0 a 100 (para facilitar interpretacion)</span></a>
<a class="sourceLine" id="cb8-11" title="11">elsoc<span class="op">$</span>merit &lt;-</a>
<a class="sourceLine" id="cb8-12" title="12"><span class="st">  </span>(elsoc<span class="op">$</span>merit<span class="op">-</span><span class="kw">min</span>(elsoc<span class="op">$</span>merit,<span class="dt">na.rm=</span>T))<span class="op">/</span>(<span class="kw">max</span>(elsoc<span class="op">$</span>merit,<span class="dt">na.rm=</span>T)<span class="op">-</span><span class="kw">min</span>(elsoc<span class="op">$</span>merit,<span class="dt">na.rm=</span>T))<span class="op">*</span><span class="dv">100</span></a></code></pre></div>
</div>
<div id="recodificacion-variable-estatus-subjetivo" class="section level2">
<h2>Recodificacion variable Estatus subjetivo</h2>
<ul>
<li>[<code>d01_01</code>]: “Estatus Social Subjetivo: Donde se ubicaria ud. en la sociedad chilena” (0 = el nivel mas bajo; 10 = el nivel mas alto)</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">elsoc<span class="op">$</span>ess &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(elsoc<span class="op">$</span>d01_<span class="dv">01</span>) <span class="co"># Estatus Social Subjetivo</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="kw">table</span>(elsoc<span class="op">$</span>ess)</a>
<a class="sourceLine" id="cb9-3" title="3"><span class="kw">summary</span>(elsoc<span class="op">$</span>ess)</a></code></pre></div>
<pre><code>## 
##   0   1   2   3   4   5   6   7   8   9  10 
##  44  84 207 439 677 975 310 116  37   4  22 
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
##    0.00    3.00    5.00    4.33    5.00   10.00      12</code></pre>
</div>
<div id="recodificacion-variables-estatus-objetivo" class="section level2">
<h2>Recodificacion variables Estatus objetivo</h2>
<div id="ingresos-del-hogar" class="section level3">
<h3>Ingresos del hogar</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">summary</span>(elsoc<span class="op">$</span>m29) <span class="co"># ingresos total ; NA == 587</span></a></code></pre></div>
<pre><code>##       Min.    1st Qu.     Median       Mean    3rd Qu.       Max.       NA&#39;s 
##          0     267500     420000    2477852     700000 4000000000        587</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">summary</span>(elsoc<span class="op">$</span>m30) <span class="co"># ingresos tramos</span></a></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
##   1.000   3.000   6.000   7.415  11.000  20.000    2479</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">summary</span>(elsoc<span class="op">$</span>nhogar1) <span class="co"># tamannio del hogar</span></a></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   1.000   2.000   3.000   3.077   4.000  14.000</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">elsoc<span class="op">$</span>m29[elsoc<span class="op">$</span>m29<span class="op">==</span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb17-2" title="2"><span class="co"># Remplazar NA por media de categorias Ingreso -------------------------------#</span></a>
<a class="sourceLine" id="cb17-3" title="3">elsoc<span class="op">$</span>mean_tramos &lt;-<span class="st"> </span><span class="ot">NA</span> <span class="co"># creamos una variable vacia</span></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="co"># remplazamos ...</span></a>
<a class="sourceLine" id="cb17-5" title="5">elsoc<span class="op">$</span>mean_tramos[elsoc<span class="op">$</span>m30<span class="op">==</span><span class="dv">1</span>] &lt;-<span class="dv">110000</span></a>
<a class="sourceLine" id="cb17-6" title="6">elsoc<span class="op">$</span>mean_tramos[elsoc<span class="op">$</span>m30<span class="op">==</span><span class="dv">2</span>] &lt;-<span class="fl">250000.5</span></a>
<a class="sourceLine" id="cb17-7" title="7">elsoc<span class="op">$</span>mean_tramos[elsoc<span class="op">$</span>m30<span class="op">==</span><span class="dv">3</span>] &lt;-<span class="fl">305000.5</span></a>
<a class="sourceLine" id="cb17-8" title="8">elsoc<span class="op">$</span>mean_tramos[elsoc<span class="op">$</span>m30<span class="op">==</span><span class="dv">4</span>] &lt;-<span class="fl">355000.5</span></a>
<a class="sourceLine" id="cb17-9" title="9">elsoc<span class="op">$</span>mean_tramos[elsoc<span class="op">$</span>m30<span class="op">==</span><span class="dv">5</span>] &lt;-<span class="fl">400000.5</span></a>
<a class="sourceLine" id="cb17-10" title="10">elsoc<span class="op">$</span>mean_tramos[elsoc<span class="op">$</span>m30<span class="op">==</span><span class="dv">6</span>] &lt;-<span class="fl">445000.5</span></a>
<a class="sourceLine" id="cb17-11" title="11">elsoc<span class="op">$</span>mean_tramos[elsoc<span class="op">$</span>m30<span class="op">==</span><span class="dv">7</span>] &lt;-<span class="fl">490000.5</span></a>
<a class="sourceLine" id="cb17-12" title="12">elsoc<span class="op">$</span>mean_tramos[elsoc<span class="op">$</span>m30<span class="op">==</span><span class="dv">8</span>] &lt;-<span class="fl">535000.5</span></a>
<a class="sourceLine" id="cb17-13" title="13">elsoc<span class="op">$</span>mean_tramos[elsoc<span class="op">$</span>m30<span class="op">==</span><span class="dv">9</span>] &lt;-<span class="fl">585000.5</span></a>
<a class="sourceLine" id="cb17-14" title="14">elsoc<span class="op">$</span>mean_tramos[elsoc<span class="op">$</span>m30<span class="op">==</span><span class="dv">10</span>]&lt;-<span class="fl">640000.5</span></a>
<a class="sourceLine" id="cb17-15" title="15">elsoc<span class="op">$</span>mean_tramos[elsoc<span class="op">$</span>m30<span class="op">==</span><span class="dv">11</span>]&lt;-<span class="fl">700000.5</span></a>
<a class="sourceLine" id="cb17-16" title="16">elsoc<span class="op">$</span>mean_tramos[elsoc<span class="op">$</span>m30<span class="op">==</span><span class="dv">12</span>]&lt;-<span class="fl">765000.5</span></a>
<a class="sourceLine" id="cb17-17" title="17">elsoc<span class="op">$</span>mean_tramos[elsoc<span class="op">$</span>m30<span class="op">==</span><span class="dv">13</span>]&lt;-<span class="fl">845000.5</span></a>
<a class="sourceLine" id="cb17-18" title="18">elsoc<span class="op">$</span>mean_tramos[elsoc<span class="op">$</span>m30<span class="op">==</span><span class="dv">14</span>]&lt;-<span class="fl">935000.5</span></a>
<a class="sourceLine" id="cb17-19" title="19">elsoc<span class="op">$</span>mean_tramos[elsoc<span class="op">$</span>m30<span class="op">==</span><span class="dv">15</span>]&lt;-<span class="fl">1040000.5</span></a>
<a class="sourceLine" id="cb17-20" title="20">elsoc<span class="op">$</span>mean_tramos[elsoc<span class="op">$</span>m30<span class="op">==</span><span class="dv">16</span>]&lt;-<span class="fl">1180000.5</span></a>
<a class="sourceLine" id="cb17-21" title="21">elsoc<span class="op">$</span>mean_tramos[elsoc<span class="op">$</span>m30<span class="op">==</span><span class="dv">17</span>]&lt;-<span class="fl">1375000.5</span></a>
<a class="sourceLine" id="cb17-22" title="22">elsoc<span class="op">$</span>mean_tramos[elsoc<span class="op">$</span>m30<span class="op">==</span><span class="dv">18</span>]&lt;-<span class="fl">1670000.5</span></a>
<a class="sourceLine" id="cb17-23" title="23">elsoc<span class="op">$</span>mean_tramos[elsoc<span class="op">$</span>m30<span class="op">==</span><span class="dv">19</span>]&lt;-<span class="fl">2275000.5</span></a>
<a class="sourceLine" id="cb17-24" title="24">elsoc<span class="op">$</span>mean_tramos[elsoc<span class="op">$</span>m30<span class="op">==</span><span class="dv">20</span>]&lt;-<span class="dv">3726106</span></a>
<a class="sourceLine" id="cb17-25" title="25"><span class="kw">table</span>(elsoc<span class="op">$</span>mean_tramos) <span class="co"># chequeamos</span></a></code></pre></div>
<pre><code>## 
##    110000  250000.5  305000.5  355000.5  400000.5  445000.5  490000.5  535000.5 
##        49        42        36        35        33        33        38        21 
##  585000.5  640000.5  700000.5  765000.5  845000.5  935000.5 1040000.5 1180000.5 
##        26        16        18        15        11        14        19        13 
## 1375000.5 1670000.5 2275000.5   3726106 
##         4        10         8         7</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">elsoc<span class="op">$</span>m29 &lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="dt">test =</span> (<span class="kw">is.na</span>(elsoc<span class="op">$</span>m29)),<span class="co">#¿es el valor un NA?</span></a>
<a class="sourceLine" id="cb19-2" title="2">                    <span class="dt">yes =</span> elsoc<span class="op">$</span>mean_tramos, <span class="co">#Si es verdadero, remplazar por el valor de mean_tramos</span></a>
<a class="sourceLine" id="cb19-3" title="3">                    <span class="dt">no =</span> elsoc<span class="op">$</span>m29)<span class="co"># Si es falso, remplazar por el valor del m29</span></a>
<a class="sourceLine" id="cb19-4" title="4"></a>
<a class="sourceLine" id="cb19-5" title="5"><span class="kw">summary</span>(elsoc<span class="op">$</span>m29) <span class="co"># NA = 147</span></a></code></pre></div>
<pre><code>##       Min.    1st Qu.     Median       Mean    3rd Qu.       Max.       NA&#39;s 
##      20000     280000     445000    2182986     700000 4000000000        147</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="co"># cambiamos el nombre de las variables inghogar = m29; nhogar=nhogar1</span></a>
<a class="sourceLine" id="cb21-2" title="2">elsoc &lt;-<span class="st"> </span><span class="kw">rename</span>(elsoc, <span class="dt">inghogar=</span>m29, <span class="dt">nhogar=</span>nhogar1)</a>
<a class="sourceLine" id="cb21-3" title="3"><span class="co"># ingreso neto = ingreso del hogar / numero de personas en el hogar</span></a>
<a class="sourceLine" id="cb21-4" title="4">elsoc<span class="op">$</span>ingneto   &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(elsoc<span class="op">$</span>inghogar<span class="op">/</span>elsoc<span class="op">$</span>nhogar)</a>
<a class="sourceLine" id="cb21-5" title="5"><span class="co"># logaritmo natural del ingreso neto (para normalizar la distribucion sesgada del ingreso)</span></a>
<a class="sourceLine" id="cb21-6" title="6">elsoc<span class="op">$</span>lningneto &lt;-<span class="st"> </span><span class="kw">log</span>(elsoc<span class="op">$</span>ingneto)</a>
<a class="sourceLine" id="cb21-7" title="7"></a>
<a class="sourceLine" id="cb21-8" title="8"><span class="kw">summary</span>(elsoc<span class="op">$</span>ingneto)</a></code></pre></div>
<pre><code>##       Min.    1st Qu.     Median       Mean    3rd Qu.       Max.       NA&#39;s 
##       7500      95000     150000    1028152     267500 2000000000        147</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">summary</span>(elsoc<span class="op">$</span>lningneto)</a></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
##   8.923  11.462  11.918  12.006  12.497  21.416     147</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="co">#---Deciles (ingreso per capita hogar)------------------------------------------------</span></a>
<a class="sourceLine" id="cb25-2" title="2">elsoc &lt;-<span class="st"> </span>elsoc <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">inc10h =</span> <span class="kw">ntile</span>(inghogar, <span class="dv">10</span>)) <span class="co"># Crear Deciles de ingreso</span></a>
<a class="sourceLine" id="cb25-3" title="3">elsoc<span class="op">$</span>D10h &lt;-<span class="st"> </span><span class="kw">factor</span>(elsoc<span class="op">$</span>inc10h, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>),</a>
<a class="sourceLine" id="cb25-4" title="4">                    <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;D01&quot;</span>,<span class="st">&quot;D02&quot;</span>,<span class="st">&quot;D03&quot;</span>,<span class="st">&quot;D04&quot;</span>,<span class="st">&quot;D05&quot;</span>,</a>
<a class="sourceLine" id="cb25-5" title="5">                               <span class="st">&quot;D06&quot;</span>,<span class="st">&quot;D07&quot;</span>,<span class="st">&quot;D08&quot;</span>,<span class="st">&quot;D09&quot;</span>,<span class="st">&quot;D10&quot;</span>));<span class="kw">table</span>(elsoc<span class="op">$</span>D10h)</a></code></pre></div>
<pre><code>## 
## D01 D02 D03 D04 D05 D06 D07 D08 D09 D10 
## 278 278 278 278 278 278 278 278 278 278</code></pre>
</div>
<div id="educación" class="section level3">
<h3>Educación</h3>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">table</span>(elsoc<span class="op">$</span>m01) <span class="co"># Educacion en ELSOC</span></a></code></pre></div>
<pre><code>## 
##   1   2   3   4   5   6   7   8   9  10 
##  37 322 297 394 857 102 381 186 303  46</code></pre>
<p><strong>Recodificación <a href="http://uis.unesco.org/sites/default/files/documents/isced-2011-sp.pdf">CINE 2011 (UNESCO)</a></strong></p>
<pre><code>1.  Sin estudios                                = [CINE 0   ] =  1
2.  Educacion Basica o Preparatoria incompleta  = [CINE 0   ] =  1
3.  Educacion Basica o Preparatoria completa    = [CINE 1,2 ] =  2
4.  Educacion Media o Humanidades incompleta    = [CINE 3   ] =  3
5.  Educacion Media o Humanidades completa      = [CINE 3   ] =  3
6.  Tecnico Superior incompleta                 = [CINE 5   ] =  4
7.  Tecnico Superior completa                   = [CINE 5   ] =  4
8.  Universitaria incompleta                    = [CINE 6   ] =  5
9.  Universitaria completa                      = [CINE 6   ] =  6
10. Estudios de posgrado (magister o doctorado) = [CINE 7, 8] =  6</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="co"># recodificacion usando funcion &#39;recode&#39; de la libreria car</span></a>
<a class="sourceLine" id="cb30-2" title="2">elsoc<span class="op">$</span>edcine &lt;-<span class="st"> </span>car<span class="op">::</span><span class="kw">recode</span>(elsoc<span class="op">$</span>m01, <span class="st">&quot;c(1,2)=1; c(3)=2;c(4,5)=3;c(6,7)=4;c(8,9,10)=5&quot;</span>)</a>
<a class="sourceLine" id="cb30-3" title="3"><span class="kw">round</span>(<span class="kw">prop.table</span>(<span class="kw">table</span>(elsoc<span class="op">$</span>edcine)), <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## 
##     1     2     3     4     5 
## 0.123 0.102 0.428 0.165 0.183</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1">elsoc<span class="op">$</span>edcine &lt;-<span class="st"> </span><span class="kw">factor</span>(elsoc<span class="op">$</span>edcine,</a>
<a class="sourceLine" id="cb32-2" title="2">                       <span class="dt">levels =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>),</a>
<a class="sourceLine" id="cb32-3" title="3">                       <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Primaria incompleta menos&quot;</span>,</a>
<a class="sourceLine" id="cb32-4" title="4">                                <span class="st">&quot;Primaria y secundaria baja&quot;</span>,</a>
<a class="sourceLine" id="cb32-5" title="5">                                <span class="st">&quot;Secundaria alta&quot;</span>,</a>
<a class="sourceLine" id="cb32-6" title="6">                                <span class="st">&quot;Terciaria ciclo corto&quot;</span>,</a>
<a class="sourceLine" id="cb32-7" title="7">                                <span class="st">&quot;Terciaria y Postgrado&quot;</span>))</a>
<a class="sourceLine" id="cb32-8" title="8"></a>
<a class="sourceLine" id="cb32-9" title="9"><span class="kw">table</span>(elsoc<span class="op">$</span>edcine) <span class="co">#chequeamos</span></a></code></pre></div>
<pre><code>## 
##  Primaria incompleta menos Primaria y secundaria baja 
##                        359                        297 
##            Secundaria alta      Terciaria ciclo corto 
##                       1251                        483 
##      Terciaria y Postgrado 
##                        535</code></pre>
</div>
</div>
<div id="variables-control" class="section level2">
<h2>Variables control</h2>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1"><span class="co">#---Sexo----</span></a>
<a class="sourceLine" id="cb34-2" title="2">elsoc<span class="op">$</span>sexo &lt;-<span class="st"> </span>car<span class="op">::</span><span class="kw">recode</span>(elsoc<span class="op">$</span>m0_sexo, <span class="st">&quot;1=1;2=0&quot;</span>)</a>
<a class="sourceLine" id="cb34-3" title="3">elsoc<span class="op">$</span>sexo &lt;-<span class="st"> </span><span class="kw">factor</span>(elsoc<span class="op">$</span>sexo, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Hombre&quot;</span>,<span class="st">&quot;Mujer&quot;</span>)) <span class="co"># Sexo</span></a>
<a class="sourceLine" id="cb34-4" title="4"><span class="co">#Hombre=0</span></a>
<a class="sourceLine" id="cb34-5" title="5"><span class="co">#Mujer=1</span></a>
<a class="sourceLine" id="cb34-6" title="6"></a>
<a class="sourceLine" id="cb34-7" title="7"><span class="co">#---Edad----</span></a>
<a class="sourceLine" id="cb34-8" title="8">elsoc<span class="op">$</span>edad &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(elsoc<span class="op">$</span>m0_edad) <span class="co">#Edad</span></a>
<a class="sourceLine" id="cb34-9" title="9"></a>
<a class="sourceLine" id="cb34-10" title="10"><span class="co">#---Posicion Politica----</span></a>
<a class="sourceLine" id="cb34-11" title="11"><span class="co"># PREGUNTA: &quot;Autoubicacion escala izquierda-derecha&quot;</span></a>
<a class="sourceLine" id="cb34-12" title="12">  <span class="co"># (0 = izquierda; 10 = Derecha; 11 = Independiente; 12 =Ninguno)</span></a>
<a class="sourceLine" id="cb34-13" title="13">elsoc<span class="op">$</span>ppolcat  &lt;-<span class="st"> </span>car<span class="op">::</span><span class="kw">recode</span>(elsoc<span class="op">$</span>c15, <span class="st">&quot;c(0,1,2,3,4)=1;5=2;c(6,7,8,9,10)=3;11=4;12=5&quot;</span>)</a>
<a class="sourceLine" id="cb34-14" title="14">elsoc<span class="op">$</span>ppolcat  &lt;-<span class="st"> </span><span class="kw">factor</span>(elsoc<span class="op">$</span>ppolcat, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>),</a>
<a class="sourceLine" id="cb34-15" title="15">                         <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Izquierda/Centro Izquierda&quot;</span>,</a>
<a class="sourceLine" id="cb34-16" title="16">                                    <span class="st">&quot;Centro&quot;</span>,</a>
<a class="sourceLine" id="cb34-17" title="17">                                    <span class="st">&quot;Derecha/Centro Derecha&quot;</span>,</a>
<a class="sourceLine" id="cb34-18" title="18">                                    <span class="st">&quot;Independiente&quot;</span>,</a>
<a class="sourceLine" id="cb34-19" title="19">                                    <span class="st">&quot;Ninguno&quot;</span>))</a></code></pre></div>
</div>
</div>
<div id="mantener-variables-relevantes" class="section level1">
<h1>Mantener variables relevantes</h1>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="co"># selecccionamos las variables relevantes</span></a>
<a class="sourceLine" id="cb35-2" title="2">elsoc_<span class="dv">16</span> &lt;-<span class="st"> </span>elsoc <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(merit,ess,edcine,lningneto,D10h, sexo, edad,ppolcat)</a>
<a class="sourceLine" id="cb35-3" title="3"><span class="co"># dejamos solamente los casos con informacion completa (listwise deletion)</span></a>
<a class="sourceLine" id="cb35-4" title="4">elsoc_<span class="dv">16</span> &lt;-<span class="st"> </span><span class="kw">na.omit</span>(elsoc_<span class="dv">16</span>)</a>
<a class="sourceLine" id="cb35-5" title="5"><span class="kw">names</span>(elsoc_<span class="dv">16</span>) <span class="co"># comprobamos los nombres de variables</span></a></code></pre></div>
<pre><code>## [1] &quot;merit&quot;     &quot;ess&quot;       &quot;edcine&quot;    &quot;lningneto&quot; &quot;D10h&quot;      &quot;sexo&quot;     
## [7] &quot;edad&quot;      &quot;ppolcat&quot;</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="kw">head</span>(elsoc_<span class="dv">16</span>) <span class="co">#chequear</span></a></code></pre></div>
<pre><code>##   merit ess                    edcine lningneto D10h   sexo edad       ppolcat
## 1  75.0   5 Primaria incompleta menos  11.22524  D03 Hombre   64 Independiente
## 2  75.0   5           Secundaria alta  12.42922  D06 Hombre   60       Ninguno
## 3  50.0   3           Secundaria alta  11.31040  D06 Hombre   26       Ninguno
## 4  75.0   6     Terciaria y Postgrado  13.54763  D08  Mujer   51       Ninguno
## 5  62.5   4           Secundaria alta  13.10216  D06  Mujer   69       Ninguno
## 6  75.0   5           Secundaria alta  13.10216  D06  Mujer   62 Independiente</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="co"># Guardar base de datos procesada ---------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb39-2" title="2"><span class="kw">save</span>(elsoc_<span class="dv">16</span>,<span class="dt">file =</span> <span class="st">&quot;data/proc/ELSOC_ess_merit2016.RData&quot;</span>)</a></code></pre></div>
</div>
